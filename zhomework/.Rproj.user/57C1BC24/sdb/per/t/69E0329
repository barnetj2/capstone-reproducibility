{
    "contents" : "#440 Reproducibility and Statistics Assignment Homework\n\n<!-- This is an Rmd comment. -->\n<!--\nYou can make comments several lines long by inserting\nthe text in between the the start and the end of the \ncomment.\n\nComments are where I'll tell you what to do. You should\nuse the space directly below the comments to do what\nthe comment asks. You should also describe what you're\ndoing to make it obvious to the reader so they can\neasily follow your logic in a fully reproducible way.\nFor any statistical tests you run, you should explain\nthe results in plain English and present the statistics\nas you would in an APA style manuscript. For any symbols\nyou don't know how to use/can't use, feel free to use the name\ninstead (e.g. alpha)\n--> \n\n<!-- Load the politics.csv data file. -->\n\npolitics<-read.csv(\"politics.csv\")\n#This loads the politics file and attaches the name politics to the data\n\n<!-- \nCheck the structure.\nsubject, party, testtime, minwage, and sex need to be factors.\noptimismscore and income should be integer and numeric vectors.\nFix any variables that aren't right.\n-->\n\nstr(politics)\n#This explains the structure and variables of the data (subject, party, testtime, optimismscore, minwage, sex, and income)\n\n<!-- Find the minimum, mean, and variance for posttest\noptimism scores. -->\n\nsummary(politics$optimismscore[politics$testtime==\"post\"])\n#This command gives us the minimum, 1st Quartile, mean, 3rd Quartile and the maximum.  The bracketed information asks for the optimism score for the post testtime.\n\nvar(politics$optimismscore[politics$testtime==\"post\"])\n#This give sus the variance, again for posttest optimism scores\n\n<!-- Create a histogram of posttest optimism scores.\nFeel free to use the default ugly settings since\nwe didn't cover how to do this in ggplot2. If\nyou're a real go-getter, see if you can figure\nout how to make a prettier histogram with better\nlabels, etc. using ggplot2. -->\n\nhist(politics$optimismscore[politics$testtime==\"post\"])\n#We have a histogram for posttest optimism scores!  \n\n\n<!-- Run a test to determine whether political affiliation\nis independent of one's gender.\nPresent the data supporting your analyses in graphical or\ntabular form.\n-->\n\n#In order to determine if two variables are independent of each other, I use the Chi-square test.  \n\npost<-politics$testtime==\"post\"\n#The data is presented twice, so this divides and creats a shortened notation for the posttest data.\n\nchisq.test(politics$party[post],politics$sex[post])\n#This is the chi-squared test.  X-squared = 0.72674, df = 2, p-value = 0.6953\n\npre<-politics$testtime==\"pre\"\nchisq.test(politics$party[pre], politics$sex[pre])\n#I wanted to double check that the pre and post testscores elicited the same data, so I ran the chi-squared test for pretest scores also and got the same values. Yay!\n#This data shows that sex and party are independent of one another. \n\n<!-- Run a test to determine whether or not males and females\nhave different incomes.\nCreate a graph to display your data that includes the relevant\nmeans and standard errors.-->\n\n#In order to determine if males and femals have differing incomes, we need to conduct an independent t-test.  \n\nt.test(politics$income[politics$testtime==\"post\" & politics$sex==\"male\"],politics$income[politics$testtime==\"post\" & politics$sex==\"female\"])\n\nt = -1.5714, df = 61.623, p-value = 0.1212\nmean of x = 38.80751\nmean of y = 47.27310\n\n#To graph this information I will use dplyr and ggplot2, which I get ready by the following commands\n\nlibrary (\"dplyr\")\nlibrary (\"ggplot2\")\n#I designated the data I wanted to group and use as polsum, which was sex and income\npolsum<-politics%>%group_by(sex)%>%summarize(mean=mean(income),sems=sd(income)/sqrt(length(income)))\n\npolsum\n\n#To make the figure I used ggplot, assigned the polsum data and then designated x as sex and y as the means.  I then set the outline as black and the fill as green and pink. Finally, I ran the figure!\nfig<-ggplot(polsum,aes(x=factor(sex),y=mean))\n\nfig<-fig+ geom_bar(stat=\"identity\", color=\"black\", fill=c(\"deeppink\",\"darkgreen\")) \n\nfig<-fig+geom_errorbar(aes(ymax=mean+sems, ymin=mean-sems),width=.2)\n\nfig\n\n<!-- See if male and females with different political affiliations\nhave different posttest optimism scores. Create a graph to display\nyour data that includes the relevant means and standard errors.-->\n#The following is the command for a two-way between-subjects ANOVA\n\nsummary(aov(optimismscore~party*sex,data=politics[politics$testtime==\"post\",]))\n\n\n            Df Sum Sq Mean Sq F value  Pr(>F)    \nparty        2  10147    5074  27.063 4.2e-09 ***\nsex          1      7       7   0.040   0.843    \nparty:sex    2    455     227   1.213   0.304    \nResiduals   60  11248     187                    \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\n#These data show that optimism scores are associated with party affiliation.  Sex is not associated with optimism scores.  There was no interaction of party and sex.  \n\n<!-- Create a line graph for the same data. With\nerror bars of course!-->\n\nopto<-politics[politics$testtime==\"post\",]%>%group_by(party,sex)%>%summarize(mean=mean(optimismscore),sems=sd(optimismscore)/sqrt(length(optimismscore)))\nlibrary(\"ggplot2\")\nlibrary(\"dplyr\")\ncol1=(\"deeppink\")\ncol2=(\"deepskyblue2\")\nfig1<-ggplot(opto,aes(x=party, y=mean, group=sex, colour=sex))+\ngeom_line(size=1)+\ngeom_point(size=2) +\nscale_color_manual(values=c(col1,col2),name=\"Sex\",breaks=c(\"female\",\"male\"),labels=c(\"Female\", \"Male\"))+\ngeom_errorbar(aes(ymax=mean+sems, ymin=mean-sems),width=.2)+\nggtitle(\"Optimism Score by Sex and Political Affiliation\")+\nlabs(x=\"Political Party Affiliation\",y=\"optimismScore\")+\nscale_x_discrete(breaks=c(\"democrat\",\"independent\",\"republican\"),labels=c(\"Democrat\",\"Independent\",\"Republican\"))+\ntheme(plot.title=element_text(size=15,face=\"bold\",vjust=.5))+\ntheme(axis.title.x=element_text(size=12,face=\"bold\",vjust=-.25))+\ntheme(axis.title.y=element_text(size=12,face=\"bold\",vjust=1))+\ntheme(axis.text.x=element_text(size=10,face=\"bold\",color=\"black\"))+\ntheme(axis.text.y=element_text(size=10,face=\"bold\",color=\"black\"))+\ncoord_cartesian(ylim=c(min(opto$mean)-2*max(opto$sems),+\nmax(opto$mean)+2*max(opto$sems)))+\ntheme(panel.border=element_blank(),axis.line=element_line())+\ntheme(panel.grid.major.x=element_blank())+\ntheme(panel.grid.major.y=element_line(color=\"darkgrey\"))+\ntheme(panel.grid.minor.y=element_blank())+\ntheme(legend.position=c(.2,.76))+\ntheme(legend.background=element_blank())+\ntheme(legend.background=element_rect(color=\"black\"))+\ntheme(legend.title=element_blank())+\ntheme(legend.title=element_text(size=12))+\ntheme(legend.title.align=.5)+\ntheme(legend.text=element_text(size=10,face=\"bold\"))\n\nfig1\n\n<!-- Run a test to see if optimism scores pre- and post\nwatching videos depends on sex.-->\n#The following is a within subjects ANOVA test\nsummary(aov(optimismscore~testtime*sex+Error(subject/testtime),data=politics))\n\nError: subject\n    Df Sum Sq Mean Sq\nsex  1   18.5    18.5\n\nError: subject:testtime\n         Df Sum Sq Mean Sq\ntesttime  1  622.3   622.3\n\nError: Within\n              Df Sum Sq Mean Sq F value Pr(>F)\ntesttime       1    151   151.3   0.430  0.513\nsex            1     66    66.4   0.189  0.664\ntesttime:sex   1      2     2.0   0.006  0.940\nResiduals    126  44291   351.5   \n\n# According to this data, pre and post videos did not depend on sex\n\n<!-- Run a Multiple Regression Analysis to see\nwhether you can predict someones posttest optimism\nscores from their pretest optimism scores and party\naffiliation. Create a figure that shows the distributions\nof pre- and posttest optimism scores and sex and create\nlines that best fit the data for both sexes regardless of\nwhether the lines are warranted based on the statistical\nanalyses--> \n\n#The following is for the multiple regression analysis\nsummary(lm(optimismscore~income+sex,data=politics[politics$testtime==\"post\",]))\n#I made sure the plot packages were available in the library\nlibrary(\"ggplot2\")\nlibrary(\"dplyr\")\n\n#This command abbreviated posttest as pres, and the next designated the specifics for a scatter plot and regression lines.\npres<-politics[politics$testtime==\"post\",]\nfig2<-ggplot(pres,aes(x=income,y=optimismscore,color=sex))+\ngeom_point(size=2)+\ngeom_abline(intercept=60.2+2.51/2, slope=-.092,color=col1)+\ngeom_abline(intercept=60.2-2.51/2, slope=-.092,color=col2)+\nscale_color_manual(values=c(col1,col2),breaks=c(\"female\",\"male\"),\nlabels=c(\"Female\",\"Male\"))+\nggtitle(\"Optimism Predicted by Sex and Income\")+\nlabs(x=\"Income (Thousands of Dollars)\",y=\"Optimism Score\\n(Higher=More)\")+\ntheme(plot.title=element_text(size=15,face=\"bold\", vjust=.5))+\ntheme(axis.title.x=element_text(size=12,face=\"bold\", vjust=-.25))+\ntheme(axis.title.y=element_text(size=12,face=\"bold\", vjust=1))+\ntheme(axis.text.x=element_text(size=10,face=\"bold\",color=\"black\"))+\ntheme(axis.text.y=element_text(size=10,face=\"bold\",color=\"black\"))+\ntheme(panel.border=element_blank(), axis.line=element_line())+\ntheme(panel.grid.major.x=element_blank())+\ntheme(panel.grid.minor.x=element_blank())+\ntheme(panel.grid.major.y=element_line(color=\"darkgrey\"))+\ntheme(panel.grid.minor.y=element_blank())+\ntheme(legend.position=c(.83,.86))+\ntheme(legend.background=element_blank())+\ntheme(legend.title=element_blank())+\ntheme(legend.text=element_text(size=10,face=\"bold\"))\nfig2\n\n",
    "created" : 1431817804403.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3694910166",
    "id" : "69E0329",
    "lastKnownWriteTime" : 1431915998,
    "path" : "~/.PSY 441/data/HomeworkYAY.Rmd",
    "project_path" : "HomeworkYAY.Rmd",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}